---
title: Using the learn callback in actions and feedback
sidebar_label: '"Learn" function'
sidebar_position: 5
description: How to set up "learn" functionality in actions and feedbacks.
---

To make it easier for users to configure your actions and feedbacks, you can implement the `learn` callback. This is intended to allow for the options of an action or feedback to be set to match the current state of the device. For example, you can program a `learn` callback to set the value for a "Set-Position" action to set the position of a picture-in-picture to its current location on your device. The callback simply queries the current state of the device and returns the appropriate value, as described below.

When implemented, a <span style={{background: "#39f", color: "#fff", borderRadius: "5px", fontSize: "0.8em", padding: "0.5em"}}>Learn Values</span> button appears in the action or feedback allowing the user to trigger a learn event.

![Launcher window](../images/action-learn-button.png)

Implementing this callback is the same for actions and feedbacks, but the parameters do vary a little accordingly.

For an action which has a single option called `input`, one implementation could look like:

```js
learn: (event) => {
    return {
        input: this.currentDeviceState.input,
    }
},
```

In the call, you are passed the same action/feedback object as you would for other callbacks. The callback should return
the `event.options` object, with the appropriate fields updated. A good way to ensure that other options are preserved
is to start the return object with `...event.options`. In this example, only the `input` field is updated:

```js
learn: (event) => {
    return {
        ...event.options,
        input: this.currentDeviceState.inputs[event.options.output],
    }
},
```

:::warning

Make sure to include any other options in the result, as the returned value is used as the new options object. If any values are omitted, they will become undefined.

:::

If for some reason you are not able to provide any new values, you can instead return `undefined` to tell Companion to abort this `learn` operation.

```js
learn: (event) => {
    const input = this.currentDeviceState.inputs[event.options.output]

    if (input === undefined) {
        // No value in the state
        return undefined
    }

    // Return the new options
    return {
        ...event.options,
        input: input,
    }
},

```

## Further Reading

- [Autogenerated docs for the module `InstanceBase` class](https://bitfocus.github.io/companion-module-base/classes/InstanceBase.html)
- [API Overview](../connection-basics/overview.md)
- [Actions](../connection-basics/actions.md)
- [Feedbacks](../connection-basics/feedbacks.md)

You can also see the full api specification for [actions](https://bitfocus.github.io/companion-module-base/interfaces/CompanionActionDefinition.html#learn) and [feedbacks](https://bitfocus.github.io/companion-module-base/interfaces/CompanionBooleanFeedbackDefinition.html#learn).
